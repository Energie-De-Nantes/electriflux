C15:
  row_level: './/PRM'
  metadata_fields:
    Flux: 'En_Tete_Flux/Identifiant_Flux'
    Version_XSD: 'En_Tete_Flux/Version_XSD'
    Date_Creation: 'En_Tete_Flux/Date_Creation'
    Nature_Contrat: 'Contrat/Nature_Contrat'
    Code_EIC_Responsable_Equilibre: 'Contrat/Code_EIC_Responsable_Equilibre'
  data_fields:
    pdl: Id_PRM
    
    Segment_Clientele: Segment_Clientele
    Num_Depannage: Num_Depannage
    Refus_Pose_AMM: Refus_Pose_AMM
    Niveau_Ouverture_Services: Niveau_Ouverture_Services
    Teleoperable: Teleoperable
    
    # Adresse
    Adresse_Code_Postal: Adresse_Installation/Code_Postal
    Adresse_Commune: Adresse_Installation/Libelle_Commune
    
    # Alimentation
    Etat_Alimentation: Alimentation/Etat_Alimentation
    Mode_Alimentation: Alimentation/Mode_Alimentation
    P_Raccordement_Soutirage: Alimentation/P_Raccordement_Soutirage
    
    # Situation contractuelle
    Categorie: Situation_Contractuelle/Titulaire_Contrat/Categorie
    Etat_Contractuel: Situation_Contractuelle/Etat_Contractuel
    Ref_Situation_Contractuelle: Situation_Contractuelle/Ref_Situation_Contractuelle
    Date_Mise_En_Service: Situation_Contractuelle/Date_Mise_En_Service

    Puissance_Souscrite: Situation_Contractuelle/Structure_Tarifaire/Puissance_Souscrite
    Formule_Tarifaire_Acheminement: Situation_Contractuelle/Structure_Tarifaire/Formule_Tarifaire_Acheminement

    # Compteur
    Type_Compteur: Dispositif_De_Comptage/Compteur/Type
    Num_Compteur: Dispositif_De_Comptage/Compteur/Num_Serie
    Constructeur_Compteur: Dispositif_De_Comptage/Compteur/Constructeur
    Calibre_Compteur: Dispositif_De_Comptage/Compteur/Calibre

    Date_Derniere_Modification_FTA: Date_Derniere_Modification_FTA
    
    # Événement
    Nature_Evenement: Evenement_Declencheur/Nature_Evenement
    Type_Evenement: Evenement_Declencheur/Type_Evenement
    Date_Evenement: Evenement_Declencheur/Date_Evenement
    Ref_Demandeur: Evenement_Declencheur/Ref_Demandeur
    Id_Affaire: Evenement_Declencheur/Id_Affaire

  nested_fields:
    - prefix: 'Avant_'
      child_path: 'Evenement_Declencheur/Releves/Donnees_Releve/Classe_Temporelle_Distributeur'
      id_field: 'Id_Classe_Temporelle'
      value_field: 'Valeur'
      conditions:
        - xpath: '../Code_Qualification'
          value: '1'
        - xpath: 'Classe_Mesure'
          value: '1'
        - xpath: 'Sens_Mesure'
          value: '0'
      additional_fields:
        Date_Releve: '../Date_Releve'
        Nature_Index: '../Nature_Index'
        Id_Calendrier_Distributeur: '../Id_Calendrier_Distributeur'
        Id_Calendrier_Fournisseur: '../Id_Calendrier'

    - prefix: 'Après_'
      child_path: 'Evenement_Declencheur/Releves/Donnees_Releve/Classe_Temporelle_Distributeur'
      id_field: 'Id_Classe_Temporelle'
      value_field: 'Valeur'
      conditions:
        - xpath: '../Code_Qualification'
          value: '2'
        - xpath: 'Classe_Mesure'
          value: '1'
        - xpath: 'Sens_Mesure'
          value: '0'
      additional_fields:
        Date_Releve: '../Date_Releve'
        Nature_Index: '../Nature_Index'
        Id_Calendrier_Distributeur: '../Id_Calendrier_Distributeur'
        Id_Calendrier_Fournisseur: '../Id_Calendrier'

F12:
  file_regex: 'FL_\d+_\d+\.xml$'
  row_level: './/Element_Valorise'
  metadata_fields:
    Flux: 'En_Tete_Flux/Identifiant_Flux'
    Version_XSD: 'En_Tete_Flux/Version_XSD'
    Identifiant_Emetteur: 'En_Tete_Flux/Identifiant_Emetteur'
    Date_Creation: 'En_Tete_Flux/Date_Creation'
    Num_Facture: 'Rappel_En_Tete/Num_Facture'
    Date_Facture: 'Rappel_En_Tete/Date_Facture'
    Devise: 'Rappel_En_Tete/Devise'
    Agence_ERDF: 'Rappel_En_Tete/Agence_ERDF'
  data_fields:
    Num_Sous_Lot: '../Num_Sous_Lot'
    Type_Facturation: '../Type_Facturation'
    Motif_Rectif: '../Motif_Rectif'

    pdl: '../Id_PRM'
    Type_PRM: '../Type_PRM'
    Code_Segmentation_ERDF: '../Code_Segmentation_ERDF'
    Agence_ERDF: '../Agence_ERDF'
    
    Puissance_Ponderee: '../Puissance_Ponderee'
    Autoproducteur: '../Autoproducteur'
    Tarif_Souscrit: '../Tarif_Souscrit'
    
    Id_EV: 'Id_EV'
    Libelle_EV: 'Libelle_EV'
    Code_Recapitulatif: 'Code_Recapitulatif'

    CSPE_Applicable: 'CSPE_Applicable'
    Taux_TVA_Applicable: 'Taux_TVA_Applicable'
    Code_Debit_Credit: 'Code_Debit_Credit'

    # Champs communs Acheminement/Prestations/Option/Frais_Divers
    Date_Debut: '*/Date_Debut'
    Date_Fin: '*/Date_Fin'
    Unite: '*/Unite_Quantite'
    Quantite: '*/Quantite'
    Prix_Unitaire: '*/Prix_Unitaire'
    Montant_HT: '*/Montant_HT'
    
  nested_fields: []
F15:
  file_regex: 'FL_\d+_\d+\.xml$'
  row_level: './/Element_Valorise'
  metadata_fields:
    Flux: 'En_Tete_Flux/Identifiant_Flux'
    Version_XSD: 'En_Tete_Flux/Version_XSD'
    Identifiant_Emetteur: 'En_Tete_Flux/Identifiant_Emetteur'
    Date_Creation: 'En_Tete_Flux/Date_Creation'
    Identifiant_Contrat: 'En_Tete_Flux/Identifiant_Contrat'
    Num_Facture: 'Rappel_En_Tete/Num_Facture'
    Date_Facture: 'Rappel_En_Tete/Date_Facture'
    Devise: 'Rappel_En_Tete/Devise'
  data_fields:
    Num_Valorisation: '../../Num_Valorisation'
    Type_Facturation: '../../Type_Facturation'
    Motif_Rectif_Facture: '../../Motif_Rectif_Facture'
    Total_Valorise_HT: '../../Total_Valorise_HT'
    pdl: '../../Donnees_PRM/Id_PRM'
    Code_Commune: '../../Donnees_PRM/Code_Commune'
    Code_Departement: '../../Donnees_PRM/Code_Departement'
    Ref_Situation_Contractuelle: '../../Donnees_PRM/Ref_Situation_Contractuelle'
    Type_Compteur: '../../Donnees_PRM/Type_Compteur'
    Nature_EV: '../Nature_EV'
    Id_EV: 'Id_EV'
    Libelle_EV: 'Libelle_EV'
    Taux_TVA_Applicable: 'Taux_TVA_Applicable'
    Type_TVA_Applicable: 'Type_TVA_Applicable'
    Code_Type_TVA_Applicable: 'Code_Type_TVA_Applicable'
    Formule_Tarifaire_Acheminement: 'Formule_Tarifaire_Acheminement'
    Unite_Quantite: 'Unite_Quantite'
    Prix_Unitaire: 'Prix_Unitaire'
    Quantite: 'Quantite'
    Montant_HT: 'Montant_HT'
    Date_Debut: 'Date_Debut'
    Date_Fin: 'Date_Fin'
    Puissance_Souscrite: 'Puissance_Souscrite'
    Categorie: 'Categorie'
    Controle_Puissance: 'Controle_Puissance'
    Dispositif_Comptage: 'Dispositif_Comptage'
    Regime_Compteur: 'Regime_Compteur'
    Num_Sequence: 'Num_Sequence'
  nested_fields: []

R15:
  row_level: './/PRM'
  metadata_fields:
    Flux: 'En_Tete_Flux/Identifiant_Flux'
    Libelle_Flux: 'En_Tete_Flux/Libelle_Flux'
    Version_XSD: 'En_Tete_Flux/Version_XSD'
    Identifiant_Emetteur: 'En_Tete_Flux/Identifiant_Emetteur'
    Identifiant_Destinataire: 'En_Tete_Flux/Identifiant_Destinataire'
    Date_Creation: 'En_Tete_Flux/Date_Creation'
    Nature_Contrat: 'En_Tete_Flux/Nature_Contrat'
    Identifiant_Contrat: 'En_Tete_Flux/Identifiant_Contrat'
    Instance_GRD: 'En_Tete_Flux/Instance_GRD'
  data_fields:
    pdl: 'Id_PRM'
    Type_Injection: 'Type_Injection'
    # Données de relevé
    Id_Releve: 'Donnees_Releve/Id_Releve'
    Date_Releve: 'Donnees_Releve/Date_Releve'
    Ref_Situation_Contractuelle: 'Donnees_Releve/Ref_Situation_Contractuelle'
    Num_Sequence: 'Donnees_Releve/Num_Sequence'
    Id_Structure_Horosaisonniere: 'Donnees_Releve/Id_Structure_Horosaisonniere'
    Libelle_Structure_Horosaisonniere: 'Donnees_Releve/Libelle_Structure_Horosaisonniere'
    Id_Calendrier_Distributeur: 'Donnees_Releve/Id_Calendrier_Distributeur'
    Libelle_Calendrier_Distributeur: 'Donnees_Releve/Libelle_Calendrier_Distributeur'
    Id_Calendrier: 'Donnees_Releve/Id_Calendrier'
    Libelle_Calendrier: 'Donnees_Releve/Libelle_Calendrier'
    Type_Client: 'Donnees_Releve/Type_Client'
    Niveau_Ouverture_Services: 'Donnees_Releve/Niveau_Ouverture_Services'
    Type_Compteur: 'Donnees_Releve/Type_Compteur'
    Autoconsommation_Collective: 'Donnees_Releve/Autoconsommation_Collective'
    Statut_Releve: 'Donnees_Releve/Statut_Releve'
    Nature_Consommation: 'Donnees_Releve/Nature_Consommation'
    Origine_Evenement: 'Donnees_Releve/Origine_Evenement'
    Motif_Releve: 'Donnees_Releve/Motif_Releve'
    Nature_Index: 'Donnees_Releve/Nature_Index'
    Motif_Rectif: 'Donnees_Releve/Motif_Rectif'
    Id_Releve_Precedent: 'Donnees_Releve/Id_Releve_Precedent'
    Date_Releve_Precedent: 'Donnees_Releve/Date_Releve_Precedent'
    Motif_Releve_Precedent: 'Donnees_Releve/Motif_Releve_Precedent'
    Nature_Index_Precedent: 'Donnees_Releve/Nature_Index_Precedent'
    Id_Affaire: 'Donnees_Releve/Id_Affaire'
    Ref_Demandeur: 'Donnees_Releve/Ref_Demandeur'
    Ref_Regroupement_Demandeur: 'Donnees_Releve/Ref_Regroupement_Demandeur'
    Date_Theorique_Prochaine_Releve: 'Donnees_Releve/Date_Theorique_Prochaine_Releve'
  nested_fields:
    - prefix: 'Dist_'
      child_path: 'Donnees_Releve/Classe_Temporelle_Distributeur'
      id_field: 'Id_Classe_Temporelle'
      value_field: 'Valeur'
      additional_fields:
        Libelle_Classe_Temporelle: 'Libelle_Classe_Temporelle'
        Rang_Cadran: 'Rang_Cadran'
        Classe_Mesure: 'Classe_Mesure'
        Unite_Mesure: 'Unite_Mesure'
        Sens_Mesure: 'Sens_Mesure'
        Valeur_Precedent: 'Valeur_Precedent'
        Nb_Chiffres_Cadran: 'Nb_Chiffres_Cadran'
        Indicateur_Passage_A_Zero: 'Indicateur_Passage_A_Zero'
        Coefficient_Lecture: 'Coefficient_Lecture'
        Num_Serie: 'Num_Serie'
    - prefix: 'Temp_'
      child_path: 'Donnees_Releve/Classe_Temporelle'
      id_field: 'Id_Classe_Temporelle'
      value_field: 'Valeur'
      additional_fields:
        Libelle_Classe_Temporelle: 'Libelle_Classe_Temporelle'
        Rang_Cadran: 'Rang_Cadran'
        Classe_Mesure: 'Classe_Mesure'
        Unite_Mesure: 'Unite_Mesure'
        Sens_Mesure: 'Sens_Mesure'
        Valeur_Precedent: 'Valeur_Precedent'
        Nb_Chiffres_Cadran: 'Nb_Chiffres_Cadran'
        Indicateur_Passage_A_Zero: 'Indicateur_Passage_A_Zero'
        Coefficient_Lecture: 'Coefficient_Lecture'
        Num_Serie: 'Num_Serie'
R151:
  row_level: './/PRM'
  metadata_fields:
    Flux: 'En_Tete_Flux/Identifiant_Flux'
    Libelle_Flux: 'En_Tete_Flux/Libelle_Flux'
    Version_XSD: 'En_Tete_Flux/Version_XSD'
    Identifiant_Emetteur: 'En_Tete_Flux/Identifiant_Emetteur'
    Identifiant_Destinataire: 'En_Tete_Flux/Identifiant_Destinataire'
    Date_Creation: 'En_Tete_Flux/Date_Creation'
    Identifiant_Contrat: 'En_Tete_Flux/Identifiant_Contrat'
    Numero_Abonnement: 'En_Tete_Flux/Numero_Abonnement'
    Unite_Mesure_Index: 'En_Tete_Flux/Unite_Mesure_Index'
    Unite_Mesure_Puissance: 'En_Tete_Flux/Unite_Mesure_Puissance'
  data_fields:
    pdl: 'Id_PRM'
    # Données de relevé
    Date_Releve: 'Donnees_Releve/Date_Releve'
    Id_Calendrier_Fournisseur: 'Donnees_Releve/Id_Calendrier_Fournisseur'
    Libelle_Calendrier_Fournisseur: 'Donnees_Releve/Libelle_Calendrier_Fournisseur'
    Id_Calendrier_Distributeur: 'Donnees_Releve/Id_Calendrier_Distributeur'
    Libelle_Calendrier_Distributeur: 'Donnees_Releve/Libelle_Calendrier_Distributeur'
    Id_Affaire: 'Donnees_Releve/Id_Affaire'
    # Puissance maximale
    Puissance_Maximale: 'Donnees_Releve/Puissance_Maximale/Valeur'
  nested_fields:
    - prefix: 'Dist_'
      child_path: 'Donnees_Releve/Classe_Temporelle_Distributeur'
      id_field: 'Id_Classe_Temporelle'
      value_field: 'Valeur'
      additional_fields:
        Libelle_Classe_Temporelle: 'Libelle_Classe_Temporelle'
        Rang_Cadran: 'Rang_Cadran'
        Indice_Vraisemblance: 'Indice_Vraisemblance'

RX5:
  file_format: 'json'
  file_regex: 'RX5_.*\.json$'
  row_level: '$.mesures[*]'
  metadata_fields:
    siDemandeur: '$.header.siDemandeur'
    codeFlux: '$.header.codeFlux'
    idDemande: '$.header.idDemande'
    modePublication: '$.header.modePublication'
    idPublication: '$.header.idPublication'
    format: '$.header.format'
  data_fields:
    pdl: 'idPrm'
    dateDebut: 'periode.dateDebut'
    dateFin: 'periode.dateFin'
    etapeMetier: 'contexte[0].etapeMetier'
    idMotifReleve: 'contexte[0].idMotifReleve'
    libelleMotifReleve: 'contexte[0].libelleMotifReleve'
    grandeurMetier: 'contexte[0].grandeur[0].grandeurMetier'
    grandeurPhysique: 'contexte[0].grandeur[0].grandeurPhysique'
    unite: 'contexte[0].grandeur[0].unite'
    codeGrille: 'contexte[0].grandeur[0].calendrier[0].codeGrille'
    libelleGrille: 'contexte[0].grandeur[0].calendrier[0].libelleGrille'
    codeCalendrier: 'contexte[0].grandeur[0].calendrier[0].codeCalendrier'
    libelleCalendrier: 'contexte[0].grandeur[0].calendrier[0].libelleCalendrier'
  nested_fields:
    - prefix: 'CT_'
      child_path: 'contexte[*].grandeur[*].calendrier[*].classeTemporelle[*]'
      id_field: 'idClasseTemporelle'
      value_field: 'quantite[0].quantite'
      additional_fields:
        libelleClasseTemporelle: 'libelleClasseTemporelle'
        dateCreation: 'quantite[0].dateCreation'
        dbtMesure: 'quantite[0].dbtMesure'
        finMesure: 'quantite[0].finMesure'
        codeNature: 'quantite[0].codeNature'
        libelleNature: 'quantite[0].libelleNature'
        codeStatut: 'quantite[0].codeStatut'
        libelleStatut: 'quantite[0].libelleStatut'